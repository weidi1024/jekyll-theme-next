---
title: 实验室电脑安装Ubuntu18.04 caffe tensorflow等
date: 2019-07-16 22:00:00
categories: 实验室
tags: 实验室 ubuntu
mathjax: true

---
*ubuntu 安装系统记录*
---

# 电脑硬件
> DELL-PRECSION TOWER 7910
Intel Xeon(R) CPU E5-2630 v4 @ 2.20GHz × 20 
GeForce GTX 1080 Ti
128 GB
2 TB + 256 GB

# 安装系统
下载ubuntu1804系统安装包，地址
利用U盘制作启动盘
插入电脑，开机按F12进入启动项选择
选择U盘，进行安装
此处网上教程很多，不在赘述


# apt换源
打开软件和更新
ubuntu软件-下载自-进入修改为国内的地址，比如aliyun的
关闭并更新
升级软件（可选）
	sudo apt-get update
	sudo apt-get upgrade


# pip
## 安装pip
pip是python包的管理

	sudo apt-get install python-pip python-dev build-essential
	pip install --upgrade pip
## pip换源
默认的源服务器在国外，国内访问太慢，修改为国内的服务器访问起来较快。
修改 ~/.pip/pip.conf (没有就创建一个)， 如下：

	mkdir ~/.pip/
	geidt ~/.pip/pip.conf
输入如下内容并保存

	[global]
	index-url = https://mirrors.aliyun.com/pypi/simple/
pip换源之后速度真的是非常舒爽...


# 安装显卡驱动430.34
安装依赖项

	sudo apt-get install dkms build-essential linux-headers-generic apt-show-versions
禁用nouveau

	sudo gedit /etc/modprobe.d/blacklist.conf
在最后一行加入

	blacklist nouveau
	blacklist lbm-nouveau
	options nouveau modeset=0
	alias nouveau off
	alias lbm-nouveau off
保存，并执行如下命令

	echo options nouveau modeset=0 | sudo tee -a /etc/modprobe.d/nouveau-kms.conf
	sudo update-initramfs -u
重启，开机后执行：

	sudo ./NVIDIA-Linux-*.run
遇到要选择的地方，都是默认选择
安装完成后执行

	nvidia-smi
(查看nvidia信息）
出现如下信息就说明安装成功了


# 安装相关依赖项
	sudo apt-get install libprotobuf-dev libleveldb-dev libsnappy-dev libopencv-dev libhdf5-serial-dev protobuf-compiler libboost-all-dev libopenblas-dev liblapack-dev libatlas-base-dev libgflags-dev libgoogle-glog-dev liblmdb-dev

# 安装cuda10.0

	sudo ./runpackage/cuda_9.0.176_384.81_linux.run
Ctrl C退出条款页面，输入accept
除了询问是否安装显卡驱动的时候选择NO,其他都是选择Yes或者默认。
安装完成后需要设置环境变量和动态链接库
执行

	sudo gedit ~/.bashrc
写入

	export PATH=/usr/local/cuda/bin${PATH:+:${PATH}}
	export LD_LIBRARY_PATH=/usr/local/cuda/lib64${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}}
	export CUDA_HOME=/usr/local/cuda
执行

	sudo gedit /etc/profile

写入

	export PATH=/usr/local/cuda/bin:$PATH
执行

	sudo gedit /etc/ld.so.conf.d/cuda.conf
写入

	/usr/local/cuda/lib64

执行

	sudo ldconfig
然后重新启动

	reboot
重启后执行检查

	nvcc --version
测试一下看看cuda是否安装成功

	cd /home/weidi/NVIDIA_CUDA-9.0_Samples/1_Utilities/deviceQuery 
	sudo make -j4
	./deviceQuery
最后一行PASS即可


# 安装cudnn7.4
解压后进入cuda文件夹

	sudo cp include/cudnn.h /usr/local/cuda/include
	sudo cp lib64/libcudnn* /usr/local/cuda/lib64
	sudo chmod a+r /usr/local/cuda/include/cudnn.h /usr/local/cuda/lib64/libcudnn*
对，直接拷贝过去就可以了


# 安装相关依赖项

	sudo apt-get install build-essential cmake git libgtk2.0-dev pkg-config libavcodec-dev libavformat-dev libswscale-dev python-dev python-numpy libtbb2 libtbb-dev libjpeg-dev libtiff5-dev libdc1394-22-dev libatlas-base-dev gfortran



# 安装openblas
	sudo apt-get install libopenblas-dev
	sudo apt-get install libopenblas-base
可以到 https://github.com/xianyi/OpenBLAS/releases 下载你喜欢的版本解压到指定目录，也可以直接git clone
下载后进入文件夹

	cd OpenBLAS
	make -j10
	sudo make --PREFIX=/usr/local/OpenBLAS/ install

测试OpenBLAS

	gedit ./test.c
输入如下内容

	gcc ./test.c  -I /usr/local/OpenBLAS/include/ -L /usr/local/OpenBLAS/lib -lopenblas
会在当前文件夹下生成可执行文件　a.out

	a.out
结果如下
> 0.000000 1.000000 2.000000 3.000000 4.000000 5.000000 6.000000 7.000000 8.000000 9.000000 
> 90.000000 81.000000 72.000000 63.000000 54.000000 45.000000 36.000000 27.000000 18.000000 9.000000
